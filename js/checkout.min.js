var cartList = new Object();

async function checkoutList() {
    await fetch("https://projeto-bd2.herokuapp.com/produtos", {
      headers: {
        "content-type": "application/json",
      },
      method: "GET",
    }).then(async (response) => {
        var total = 0
        cartList = JSON.parse(window.localStorage.getItem('cart'));
        
        var bd = await response.json();
        console.log(cartList);
        console.log(bd)
        for (i of Object.keys(cartList)){
            for (j of Object.keys(bd)){
                if(cartList[i].id_produto === bd[j].id_produto){
                    var list = document.querySelector(".rounded")
                    var html = `
                    <div class="media mb-2 border-bottom">
                        <div class="media-body"> <a href="detail.html">${bd[j].nome}</a>
                            <div class="small text-muted">Pre√ßo: R$${bd[j].preco.toLocaleString('pt-BR',{minimumFractionDigits:2})} <span class="mx-2">|</span> Qtd:${cartList[i].count} <span class="mx-2">|</span> Subtotal: R$${(bd[j].preco * cartList[i].count).toLocaleString('pt-BR',{minimumFractionDigits:2})}</div>
                        </div>
                    </div>
                    `

                list.insertAdjacentHTML("afterbegin", html)
                total = total + (bd[j].preco * cartList[i].count)

                window.localStorage.setItem('total', JSON.stringify(total))
                }
            }

        }
        
        document.querySelector("#checkoutTotal").innerHTML = `R$${total.toLocaleString('pt-BR',{minimumFractionDigits:2})}`
        document.querySelector("#checkoutFinal").innerHTML = `R$${total.toLocaleString('pt-BR',{minimumFractionDigits:2})}`
      
    });
  }


checkoutList();